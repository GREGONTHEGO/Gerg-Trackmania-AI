# Stage 1: Retrieve Data and Move Vehicle

As stated above the goal for the first stage of this problem was to gather information from the game Trackmania 2020 and be able to exercise control on the vehicle such that it moves in game following a python script. The way that I achieved this was through a downloadable modification to the game called Openplanet. This allows the user to code and test plugins for the game. To create a plugin, I needed to code an angelscript file as well as an info.toml that would tell the game to load my script. The script that I used can be found in the 'plugins/GergBot/' folder. The way that the GergBot script works is by creating a menu item on the openplanet modification that will open a local socket. The local socket will then recieve information from the update function. This information includes the speed of the car, the position of the car, the velocity of the car (in x,y, and z directions), and lastly the number of checkpoints that the vehicle has driven through. As of right now, there have been a few errors that I created with this script. The first is that I have not been regulating how often the information is sent to the socket. This led to a funny reward system that I will talk about in a future stage. The second, was that I learned that within a toml file you need to specify what is part of your plugin, 'meta', and what is part of the dependencies, 'script'. On the python side, during this stage I just created some threads. One of the threads was for listening to the socket and editing a global variable latest_state. The other thread was taking the latest_state and if the speed was less than 50 m/s, which is the metric that the games speed is in, it would press the gas and if the speed was greater than 50 m/s then it would step off the gas. Throughout this process I created many memory leaks and realised that the way that the python library that I am using, pynput, is working is that it constantly is holding whatever key I tell it to down until the script stops. This leads to me clicking on another screen and having a ton of ws being left there.

# Stage 2: Initial Machine Learning Model Implementation

https://github.com/user-attachments/assets/5507724a-d6ce-42fa-a510-b82c61f4d2be

During this phase, I restructured my python code. I created a training function, a compute reward function, a policy loss function, and most importantly a genModel function. The genModel function creates a small neural network. it has 8 inputs, based on the values recieved from the angelscript plugin, 2 hidden layers with 512 neurons each, and four outputs, corresponding to the four inputs: forward, backward, left, and right. I also changed how my main calls the functions. I have an inference and a read_game_state function. These two functions are what run in real time to save data on runs for training. The read_game_state listens and parses what comes out of the socket and the inference will save and run that information through the current model. Then after the inference runs and saves enough data, the threads will be closed and training on the data stored during the last epoch will begin. The first successful implementation of the model is in the video shown above. The odd reward calculation was because my python script was not synced with the plugin that I made. This caused some sets of states to not be connected. This led to the vehicle learning that the best way to get rewards was throwing itself over the back of my track so that it would get a large speed.
